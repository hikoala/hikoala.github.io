"use strict";(self.webpackChunkfront_documentation=self.webpackChunkfront_documentation||[]).push([[204],{7605:function(e,t,n){n.r(t),n.d(t,{assets:function(){return u},contentTitle:function(){return c},default:function(){return m},frontMatter:function(){return s},metadata:function(){return l},toc:function(){return p}});var o=n(6033),a=n(7839),r=(n(2735),n(9530)),i=["components"],s={sidebar_position:5},c="Be informed of claims status",l={unversionedId:"guides/webhooks",id:"guides/webhooks",title:"Be informed of claims status",description:"Do you want to be proactively informed of your customer claim status? You're at the right place! \ud83d\udcaa",source:"@site/resources/partner-api/guides/webhooks.md",sourceDirName:"guides",slug:"/guides/webhooks",permalink:"/partner-api/guides/webhooks",tags:[],version:"current",sidebarPosition:5,frontMatter:{sidebar_position:5},sidebar:"sidebar",previous:{title:"Update trip details",permalink:"/partner-api/guides/update"},next:{title:"Retrieve products' Terms & Conditions from the API",permalink:"/partner-api/guides/retrieve-t&c"}},u={},p=[{value:"Webhook principles",id:"webhook-principles",level:3},{value:"When do I need to interface with Koala&#39;s webhook?",id:"when-do-i-need-to-interface-with-koalas-webhook",level:3},{value:"How does it work?",id:"how-does-it-work",level:3},{value:"Subscribing to our webhook: Headers",id:"subscribing-to-our-webhook-headers",level:3},{value:"Subscribing to our webhook: Request body",id:"subscribing-to-our-webhook-request-body",level:3}],d={toc:p};function m(e){var t=e.components,n=(0,a.Z)(e,i);return(0,r.kt)("wrapper",(0,o.Z)({},d,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"be-informed-of-claims-status"},"Be informed of claims status"),(0,r.kt)("p",null,"Do you want to be proactively informed of your customer claim status? You're at the right place! \ud83d\udcaa"),(0,r.kt)("h3",{id:"webhook-principles"},"Webhook principles"),(0,r.kt)("p",null,"We have designed webhooks to which you can subscribe to receive notifications of your customers' claims."),(0,r.kt)("p",null,"You will receive notifications from us ",(0,r.kt)("strong",{parentName:"p"},"as soon as we have determined internally the status of the claims")," (usually,\nexpect to receive a notification within a few hours after the event has occurred, at the latest 48 hours). By\nsubscribing to our webhook, you will get the same information we do at the same time!"),(0,r.kt)("h3",{id:"when-do-i-need-to-interface-with-koalas-webhook"},"When do I need to interface with Koala's webhook?"),(0,r.kt)("p",null,"Subscribing to our webhook can help you with:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Claim management"),": If you handle claim management, our webhook will keep you informed of flight status and\neligibility."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Customer service"),": you can feed your CRM with claim details so that your customer service is aware of everything\nhappening with your customers."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Customer experience"),": you can contact disrupted travellers thanks to our feed to offer them special assistance or\ncare.")),(0,r.kt)("p",null,"Claim webhook allows your service to receive information about customer claims."),(0,r.kt)("h3",{id:"how-does-it-work"},"How does it work?"),(0,r.kt)("p",null,"To subscribe to our webhook, you will need to send us:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"URL on which we can POST information"),(0,r.kt)("li",{parentName:"ul"},"A secret of your choice.")),(0,r.kt)("p",null,"Once received, Koala will configure your webhook and notify your URL via HTTP POST with all\nthe details of the claims. ",(0,r.kt)("strong",{parentName:"p"},"It will be your responsibility to process the notification's content and manage the consequences to your codebase to be able to use it.")),(0,r.kt)("p",null,"You will receive one notification per claim per booking \ud83e\udd13"),(0,r.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"By default, the webhook only send notifications for eligible claims. If you are interested in receiving\nnon-eligible claims, please ask us!"))),(0,r.kt)("h3",{id:"subscribing-to-our-webhook-headers"},"Subscribing to our webhook: Headers"),(0,r.kt)("p",null,"The webhook will contain the following set of request headers:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "Accept": "application/json",\n  "Content-Type": "application/json",\n  "Koala-Signature": "<generated_signature>"\n}\n')),(0,r.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},(0,r.kt)("strong",{parentName:"p"},"Koala Signature")," is a hash generated using your client secret and the request itself \u2013 used to verify the\nauthenticity of the request."))),(0,r.kt)("br",null),(0,r.kt)("p",null,"To certify that the notifcation truly comes from Koala, you will need to run the following: "),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-javascript"},'const crypto = require("crypto");\n\nfunction verifySignature(request, secret) {\n  const hmac = crypto.createHmac("sha256", secret);\n  hmac.update(JSON.stringify(request.body), "utf8");\n  const digest = hmac.digest("hex");\n  return digest === request.headers["Koala-Signature"];\n}\n')),(0,r.kt)("h3",{id:"subscribing-to-our-webhook-request-body"},"Subscribing to our webhook: Request body"),(0,r.kt)("p",null,"The webhook requests have some common elements."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "claimedAt": "2022-02-07T11:31:27.000Z",\n  "compensation": {\n    "amount": 100,\n    "currency": "EUR"\n  },\n  "contract": {\n    "coveredEvent": {\n      "arrivalAirport": {\n        "city": "New York",\n        "iata": "JFK",\n        "name": "John F. Kennedy International Airport"\n      },\n      "arrivalDate": "2021-07-30T08:35:00.000Z",\n      "departureAirport": {\n        "city": "Paris",\n        "iata": "CDG",\n        "name": "Charles de Gaulle Airport"\n      },\n      "departureDate": "2021-07-30T07:10:00.000Z",\n      "number": "AF8223"\n    },\n    "createdAt": "2021-12-05T18:42:55.000Z",\n    "subscription": {\n      "bookingNumber": "6TG9896HTM"\n    }\n  },\n  "reason": {\n    "type": "FLIGHT_DELAYED"\n  },\n  "status": "ACCEPTED"\n}\n')),(0,r.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"For GDPR reasons, we are not sharing any information about the customer details. You will need to make the association thanks to the bookingNumber \ud83d\udc28"))))}m.isMDXComponent=!0},9530:function(e,t,n){n.d(t,{Zo:function(){return u},kt:function(){return m}});var o=n(2735);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,o,a=function(e,t){if(null==e)return{};var n,o,a={},r=Object.keys(e);for(o=0;o<r.length;o++)n=r[o],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(o=0;o<r.length;o++)n=r[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var c=o.createContext({}),l=function(e){var t=o.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},u=function(e){var t=l(e.components);return o.createElement(c.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},d=o.forwardRef((function(e,t){var n=e.components,a=e.mdxType,r=e.originalType,c=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),d=l(n),m=a,h=d["".concat(c,".").concat(m)]||d[m]||p[m]||r;return n?o.createElement(h,i(i({ref:t},u),{},{components:n})):o.createElement(h,i({ref:t},u))}));function m(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var r=n.length,i=new Array(r);i[0]=d;var s={};for(var c in t)hasOwnProperty.call(t,c)&&(s[c]=t[c]);s.originalType=e,s.mdxType="string"==typeof e?e:a,i[1]=s;for(var l=2;l<r;l++)i[l]=n[l];return o.createElement.apply(null,i)}return o.createElement.apply(null,n)}d.displayName="MDXCreateElement"}}]);